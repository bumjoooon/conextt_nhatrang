<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‚¬ì§„ | Conextt Travel</title>
  <link rel="stylesheet" href="assets/style.css" />
  <script src="assets/data.js" defer></script>
  <script src="assets/gallery-list.js" defer></script>
  <script src="assets/app.js" defer></script>
  <style>
    /* ê°¤ëŸ¬ë¦¬ íƒ­ */
    .gallery-tabs {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    .gallery-tab {
      padding: 10px 16px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: white;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }
    .gallery-tab:hover {
      border-color: var(--primary);
    }
    .gallery-tab.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }
    .gallery-tab .tab-count {
      display: inline-block;
      margin-left: 6px;
      padding: 2px 8px;
      background: rgba(0,0,0,0.1);
      border-radius: 999px;
      font-size: 12px;
    }
    .gallery-tab.active .tab-count {
      background: rgba(255,255,255,0.3);
    }

    /* ê°¤ëŸ¬ë¦¬ ê·¸ë¦¬ë“œ */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 8px;
    }
    @media(min-width: 768px) {
      .gallery-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 12px;
      }
    }

    .gallery-item {
      aspect-ratio: 1;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      background: #f3f4f6;
    }
    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
    .gallery-item:hover img {
      transform: scale(1.05);
    }

    /* ë¹ˆ ìƒíƒœ */
    .gallery-empty {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }
    .gallery-empty .empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }

    /* ë¼ì´íŠ¸ë°•ìŠ¤ */
    .lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.95);
      z-index: 9999;
      flex-direction: column;
    }
    .lightbox.active {
      display: flex;
    }

    .lightbox-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      color: white;
    }
    .lightbox-title {
      font-weight: 700;
      font-size: 14px;
    }
    .lightbox-counter {
      font-size: 14px;
      color: rgba(255,255,255,0.7);
    }
    .lightbox-close {
      width: 44px;
      height: 44px;
      border: none;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .lightbox-close:hover {
      background: rgba(255,255,255,0.2);
    }

    .lightbox-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .lightbox-content img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      border: none;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .lightbox-nav:hover {
      background: rgba(255,255,255,0.3);
    }
    .lightbox-nav.prev {
      left: 16px;
    }
    .lightbox-nav.next {
      right: 16px;
    }
    @media(max-width: 600px) {
      .lightbox-nav {
        width: 40px;
        height: 40px;
        font-size: 20px;
      }
      .lightbox-nav.prev { left: 8px; }
      .lightbox-nav.next { right: 8px; }
    }

    /* ìŠ¤ì™€ì´í”„ ì§€ì› */
    .lightbox-content.swiping img {
      transition: transform 0.1s;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a class="brand" href="index.html">
        <div class="brand-badge">C</div>
        <div>
          Conextt Travel<br />
          <small>ì‚¬ì§„</small>
        </div>
      </a>
      <nav class="nav">
        <a href="index.html">Main</a>
        <a href="schedule.html">ì—¬í–‰</a>
        <a href="vietnamese.html">ë² íŠ¸ë‚¨ì–´</a>
        <a href="photos.html">ì‚¬ì§„</a>
        <a href="videos.html">ì˜ìƒ</a>
      </nav>
    </div>
  </header>

  <main class="page">
    <div class="container">
      <section class="card">
        <h2>ğŸ“· ì‚¬ì§„ ê°¤ëŸ¬ë¦¬</h2>
        <p>ë‚ ì§œë³„ë¡œ ì‚¬ì§„ì„ í™•ì¸í•˜ì„¸ìš”. í´ë¦­í•˜ë©´ í¬ê²Œ ë³¼ ìˆ˜ ìˆì–´ìš”.</p>

        <div class="hr"></div>

        <!-- ë‚ ì§œ íƒ­ -->
        <div class="gallery-tabs" id="photo-tabs"></div>

        <!-- ê°¤ëŸ¬ë¦¬ ê·¸ë¦¬ë“œ -->
        <div class="gallery-grid" id="photo-grid"></div>

        <!-- ë¹ˆ ìƒíƒœ -->
        <div class="gallery-empty" id="photo-empty" style="display:none;">
          <div class="empty-icon">ğŸ“·</div>
          <div><b>ì•„ì§ ì‚¬ì§„ì´ ì—†ì–´ìš”</b></div>
          <p>ì—¬í–‰ì´ ëë‚˜ê³  ë§Œë‚˜ìš”!</p>
        </div>
      </section>
    </div>
  </main>

  <!-- ë¼ì´íŠ¸ë°•ìŠ¤ -->
  <div class="lightbox" id="lightbox">
    <div class="lightbox-header">
      <div class="lightbox-title" id="lightbox-title"></div>
      <div class="lightbox-counter" id="lightbox-counter"></div>
      <button class="lightbox-close" id="lightbox-close">Ã—</button>
    </div>
    <div class="lightbox-content" id="lightbox-content">
      <button class="lightbox-nav prev" id="lightbox-prev">â®</button>
      <img id="lightbox-img" src="" alt="" />
      <button class="lightbox-nav next" id="lightbox-next">â¯</button>
    </div>
  </div>

  <script>
  (function() {
    // ê°¤ëŸ¬ë¦¬ ë°ì´í„° ëŒ€ê¸°
    function waitForData(callback) {
      if (window.CONEXTT && window.CONEXTT.gallery) {
        callback();
      } else {
        setTimeout(function() { waitForData(callback); }, 50);
      }
    }

    waitForData(function() {
      var gallery = window.CONEXTT.gallery.photos || {};
      var dayInfo = window.CONEXTT.dayInfo || {};
      var folders = Object.keys(gallery).sort();

      var tabsEl = document.getElementById('photo-tabs');
      var gridEl = document.getElementById('photo-grid');
      var emptyEl = document.getElementById('photo-empty');

      // ì „ì²´ ì‚¬ì§„ ëª©ë¡ (ë¼ì´íŠ¸ë°•ìŠ¤ìš©)
      var allPhotos = [];
      var currentIndex = 0;

      // ë¹ˆ ìƒíƒœ ì²´í¬
      if (folders.length === 0) {
        emptyEl.style.display = 'block';
        return;
      }

      // íƒ­ ìƒì„±
      var currentFolder = folders[0];

      function renderTabs() {
        tabsEl.innerHTML = folders.map(function(folder) {
          var info = dayInfo[folder] || { day: '?', date: folder };
          var count = gallery[folder].length;
          var active = folder === currentFolder ? 'active' : '';
          return '<button class="gallery-tab ' + active + '" data-folder="' + folder + '">' +
            info.date + '<span class="tab-count">' + count + '</span></button>';
        }).join('');
      }

      function renderGrid() {
        var files = gallery[currentFolder] || [];
        allPhotos = files.map(function(f) {
          return 'gallery/photos/' + currentFolder + '/' + f;
        });

        if (files.length === 0) {
          gridEl.innerHTML = '<div class="gallery-empty"><div class="empty-icon">ğŸ“·</div><div>ì´ ë‚ ì§œì—ëŠ” ì‚¬ì§„ì´ ì—†ì–´ìš”</div></div>';
          return;
        }

        gridEl.innerHTML = files.map(function(file, idx) {
          var src = 'gallery/photos/' + currentFolder + '/' + file;
          return '<div class="gallery-item" data-index="' + idx + '">' +
            '<img src="' + src + '" alt="' + file + '" loading="lazy" />' +
            '</div>';
        }).join('');
      }

      // íƒ­ í´ë¦­
      tabsEl.addEventListener('click', function(e) {
        var tab = e.target.closest('.gallery-tab');
        if (!tab) return;
        currentFolder = tab.dataset.folder;
        renderTabs();
        renderGrid();
      });

      // ë¼ì´íŠ¸ë°•ìŠ¤
      var lightbox = document.getElementById('lightbox');
      var lightboxImg = document.getElementById('lightbox-img');
      var lightboxTitle = document.getElementById('lightbox-title');
      var lightboxCounter = document.getElementById('lightbox-counter');
      var lightboxContent = document.getElementById('lightbox-content');

      function openLightbox(index) {
        currentIndex = index;
        updateLightbox();
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeLightbox() {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }

      function updateLightbox() {
        lightboxImg.src = allPhotos[currentIndex];
        var info = dayInfo[currentFolder] || { date: currentFolder };
        lightboxTitle.textContent = info.date;
        lightboxCounter.textContent = (currentIndex + 1) + ' / ' + allPhotos.length;
      }

      function showPrev() {
        currentIndex = (currentIndex - 1 + allPhotos.length) % allPhotos.length;
        updateLightbox();
      }

      function showNext() {
        currentIndex = (currentIndex + 1) % allPhotos.length;
        updateLightbox();
      }

      // ê·¸ë¦¬ë“œ í´ë¦­
      gridEl.addEventListener('click', function(e) {
        var item = e.target.closest('.gallery-item');
        if (!item) return;
        openLightbox(parseInt(item.dataset.index, 10));
      });

      // ë¼ì´íŠ¸ë°•ìŠ¤ ì»¨íŠ¸ë¡¤
      document.getElementById('lightbox-close').addEventListener('click', closeLightbox);
      document.getElementById('lightbox-prev').addEventListener('click', showPrev);
      document.getElementById('lightbox-next').addEventListener('click', showNext);

      // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
      document.addEventListener('keydown', function(e) {
        if (!lightbox.classList.contains('active')) return;
        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowLeft') showPrev();
        if (e.key === 'ArrowRight') showNext();
      });

      // ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
      lightbox.addEventListener('click', function(e) {
        if (e.target === lightbox || e.target === lightboxContent) {
          closeLightbox();
        }
      });

      // ìŠ¤ì™€ì´í”„ (ëª¨ë°”ì¼)
      var touchStartX = 0;
      var touchEndX = 0;

      lightboxContent.addEventListener('touchstart', function(e) {
        touchStartX = e.changedTouches[0].screenX;
      }, { passive: true });

      lightboxContent.addEventListener('touchend', function(e) {
        touchEndX = e.changedTouches[0].screenX;
        var diff = touchStartX - touchEndX;
        if (Math.abs(diff) > 50) {
          if (diff > 0) showNext();
          else showPrev();
        }
      }, { passive: true });

      // ì´ˆê¸° ë Œë”ë§
      renderTabs();
      renderGrid();
    });
  })();
  </script>
</body>
</html>
